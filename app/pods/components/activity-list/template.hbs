<div class="activityHeader">
  <h2 class="t3 t-light">
    {{t 'activity' count=1}}

    {{#if loadActivities.isRunning}}
      {{ui-spinner}}
    {{/if}}
  </h2>

  {{activity-pagination
    meta=activityCache.meta
    current=currentPage
    onSwitch=(action 'switchPage')}}
</div>

<div class="activityList">
  {{#each activityCache as |item|}}
    {{#with (get componentsByType item.verb) as |type|}}
      {{component (concat 'activity-' type) data=item class=(concat "activity activity--" type)}}
    {{/with}}
  {{/each}}

  {{#if showForm}}
  <div class="activity activity--comment">
    <div class="activity-author"><strong>{{t 'activity.comment.title'}}</strong></div>
    <form class="activity-body activity-form" {{action "save" on="submit"}}>

      {{#validated-field
        class="formGroup"
        validation=this.validations.attrs.body
        didValidate=didValidate as |field|}}

        {{textarea value=body class="formControl formControl--sm" rows="6"}}

        {{#if field.showErrors}}
          <div class="formFeedback t-right">{{v-get this "body" "message"}}</div>
        {{/if}}

      {{/validated-field}}

      <div class="formGroup formGroup--actions">
        <button disabled={{publishComment.isRunning}} type="submit" class="button button--primary">
          {{t 'activity.comment.submitButton'}}
        </button>

        {{#if publishComment.isRunning}}
          {{ui-spinner}}
        {{/if}}
      </div>


    </form>
  </div>
  {{/if}}

</div>