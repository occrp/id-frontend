<div class="filters">
  <div class="filters-main">
    {{yield}}
  </div>
  <div class="filters-secondary">
    <div class="filters-item">
      {{#ui-dropdown as |dd|}}
        {{#dd.trigger}}Type <b class="arrow"></b>{{/dd.trigger}}
        {{#dd.body headerText="Filter by type"}}
          <div class="list">
            <a href {{action (pipe (action updateFilter 'type' null) dd.close)}} class="list-item {{if (eq type null) "is-active"}}">All</a>

            {{#each-in typeMap as |key props|}}
              <a href {{action (pipe (action updateFilter 'type' key) dd.close)}} class="list-item {{if (eq type key) "is-active"}}" data-test-filter-type={{key}}>
                <span class="iconContainer"><i class="fa {{props.icon}}"></i></span>
                <span class="iconText">{{props.name}}</span>
              </a>
            {{/each-in}}
          </div>
        {{/dd.body}}
      {{/ui-dropdown}}
    </div>
    {{#if (can "manage tickets")}}
    <div class="filters-item">
      {{#ui-dropdown as |dd|}}
        {{#dd.trigger}}Author <b class="arrow"></b>{{/dd.trigger}}
        {{#dd.body headerText="Filter by author"}}
          {{search-users
            task=searchAuthors
            current=author
            onSelect=(pipe-action (action 'applyAuthor') dd.close)}}
        {{/dd.body}}
      {{/ui-dropdown}}
    </div>
    <div class="filters-item">
      {{#ui-dropdown as |dd|}}
        {{#dd.trigger}}Assignee <b class="arrow"></b>{{/dd.trigger}}
        {{#dd.body headerText="Filter by who's assigned"}}
          {{#search-users
            task=searchStaff
            current=assignee
            onSelect=(pipe-action (action 'applyAssignee') dd.close)
          }}
            <a href class="list-item list-item--special {{if (eq assignee "none") "is-active"}}" {{action (pipe (action 'applyAssignee' "none") dd.close)}} data-test-filter-static-option="none">Assigned to nobody</a>
          {{/search-users}}
        {{/dd.body}}
      {{/ui-dropdown}}
    </div>
    {{/if}}
    <div class="filters-item">
      {{#ui-dropdown as |dd|}}
        {{#dd.trigger}}Sort <b class="arrow"></b>{{/dd.trigger}}
        {{#dd.body headerText="Sort by"}}
          <div class="list">
            {{#each-in sortFields as |key label|}}
              <a href {{action (pipe (action updateFilter 'sort' key) dd.close)}} class="list-item {{if (eq sort key) "is-active"}}" data-test-filter-sort={{key}}>{{label}}</a>
            {{/each-in}}
          </div>
        {{/dd.body}}
      {{/ui-dropdown}}
    </div>
  </div>
</div>

